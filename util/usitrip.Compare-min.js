Usitrip.Compare={toCompare:function(nObj,oObj,type,subType,subClazz){type=type.toLowerCase();for(var oldText="",newText="",len=Math.max(nObj.length,oObj.length),i=0;len>i;i++)if("tr"===type)nObj[i]&&oObj[i]&&Usitrip.Compare.trCompare(nObj[i],oObj[i],subType,subClazz);else{if(oldText=jQuery(oObj[i]).text(),newText=jQuery(nObj[i]).text(),oldText!==newText)if("td"===type){var result=Usitrip.Compare.tdCompare(newText,oldText);newText=result[0],oldText=result[1]}else if("text"===type){var result=Usitrip.Compare.textCompare(newText,oldText);newText=result[0],oldText=result[1]}else{var result=Usitrip.Compare.otherSplitCompare(newText,oldText,type);newText=result[0],oldText=result[1]}"undefined"!=typeof oObj[i]&&""!=oldText&&jQuery(oObj[i]).html(oldText),"undefined"!=typeof nObj[i]&&""!=newText&&jQuery(nObj[i]).html(newText)}},tdCompare:function(newText,oldText){return newText="<ufo>"+newText+"</ufo>",oldText="<del>"+oldText+"</del>",[newText,oldText]},textCompare:function(newText,oldText){for(var tempNewText="",tempOldText="",j=0,size=Math.max(newText.length,oldText.length);size>j;j++)"undefined"!=typeof newText[j]&&"undefined"!=typeof oldText[j]&&newText[j]!=oldText[j]?(tempNewText+="<ufo>"+newText[j]+"</ufo>",tempOldText+="<del>"+oldText[j]+"</del>"):"undefined"==typeof newText[j]&&"undefined"!=typeof oldText[j]?tempOldText+="<del>"+oldText[j]+"</del>":"undefined"!=typeof newText[j]&&"undefined"==typeof oldText[j]?tempNewText+="<ufo>"+newText[j]+"</ufo>":(tempNewText+=newText[j],tempOldText+=oldText[j]);return newText=tempNewText,oldText=tempOldText,[newText,oldText]},trCompare:function(newObj,oldObj,subType,subClazz){for(var newObjChild=$(newObj.children).filter("."+subClazz),oldObjChild=$(oldObj.children).filter("."+subClazz),j=0,size=Math.max(newObjChild.length,oldObjChild.length);size>j;j++){var newText=$(newObjChild[j]),oldText=$(oldObjChild[j]);Usitrip.Compare.toCompare(newText,oldText,subType)}},otherSplitCompare:function(newText,oldText,splitType){for(var nTexts=newText.split(splitType),oTexts=oldText.split(splitType),tempNewText="",tempOldText="",j=0,size=Math.max(nTexts.length,oTexts.length);j<Math.max(nTexts.length,oTexts.length);j++)j==size-1&&(splitType=""),"undefined"!=typeof nTexts[j]&&"undefined"!=typeof oTexts[j]&&nTexts[j]!=oTexts[j]?(tempNewText+="<ufo>"+nTexts[j]+"</ufo>"+splitType,tempOldText+="<del>"+oTexts[j]+"</del>"+splitType):"undefined"==typeof nTexts[j]&&"undefined"!=typeof oTexts[j]?tempOldText+="<del>"+oTexts[j]+"</del>"+splitType:"undefined"!=typeof nTexts[j]&&"undefined"==typeof oTexts[j]?tempNewText+="<ufo>"+nTexts[j]+"</ufo>"+splitType:(tempNewText+=nTexts[j]+splitType,tempOldText+=oTexts[j]+splitType);return[tempNewText,tempOldText]}};